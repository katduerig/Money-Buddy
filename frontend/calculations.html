<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Money Buddy</title>
  <link rel="stylesheet" href="master.css" />
</head>

<style>
  body {
    background: linear-gradient(#b23535, #4f72da)
  }
</style>

<body>
  <h1>Calculations</h1>
  <h2>Monthly Totals</h2>
</body>

<script>

  fetch('http://localhost:8000/get_month_totals').then(response => {
    return response.json()
  }).then(data => {
    console.log("data: ", data)
    for (let [date, cost] of Object.entries(data)) {
      console.log(`${date}: ${cost}`);
      var containerHTML = document.createElement('div');
      var dateHTML = document.createElement('div');
      var costHTML = document.createElement('div');

      containerHTML.className = "rowContainer"
      dateHTML.className = "date"
      costHTML.className = "cost"

      dateHTML.innerHTML = date;
      costHTML.innerHTML = cost;

      containerHTML.appendChild(dateHTML);
      containerHTML.appendChild(costHTML);

      document.body.appendChild(containerHTML);

    }

    var buffer = document.createElement('div');
    buffer.className = "buffer"
    buffer.innerHTML = 'Category Breakdown'
    document.body.appendChild(buffer)
  })


  fetch('http://localhost:8000/get_monthly_category_totals').then(response => {
    return response.json()
  }).then(data => {
    for (let [month_year, category_dictionary] of Object.entries(data)) {
      var month_yearHTML = document.createElement('div');
      month_yearHTML.className = "month_yearHTML"
      document.body.appendChild(month_yearHTML);
      month_yearHTML.innerHTML = month_year;
      for (let [category, total_amount] of Object.entries(category_dictionary)) {
        total_amount = "$" + String(total_amount.toFixed(2))
        // console.log(`${month_year}: ${category_dictionary}`);
        var totalHTML = document.createElement('div');

        totalHTML.className = "total"

        totalHTML.innerHTML = category + " " + total_amount;

        document.body.appendChild(totalHTML);
      }
      var buffer = document.createElement('div');

      buffer.className = "buffer2"
      document.body.appendChild(buffer)
    }

  })


</script>



</html>